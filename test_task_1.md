# 1. Задача по написанию тест-кейсов

### TC-001: Успешная оплата без 3-D Secure

**ID:** TC-001

**Название:** Успешная оплата заказа валидной банковской картой без прохождения 3-D Secure

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная банковская карта (например, 4111 1111 1111 1111)
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести номер карты: 4111 1111 1111 1111
4. Ввести срок действия карты: 12/26
5. Ввести CVV: 123
6. Ввести имя держателя карты: IVAN IVANOV
7. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Редирект на 3-D Secure не произошел
- Платежный шлюз вернул статус "Успешно"
- Статус заказа обновлен на "Оплачен"
- Пользователю отображено сообщение об успешной оплате
- На email пользователя отправлен чек

---

### TC-002: Успешная оплата с прохождением 3-D Secure

**ID:** TC-002

**Название:** Успешная оплата заказа с прохождением аутентификации 3-D Secure

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть банковская карта, требующая 3-D Secure (например, 4000 0000 0000 0002)
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести номер карты: 4000 0000 0000 0002
4. Ввести срок действия карты: 12/26
5. Ввести CVV: 123
6. Ввести имя держателя карты: IVAN IVANOV
7. Нажать кнопку "Оплатить"
8. Дождаться редиректа на страницу 3-D Secure
9. Ввести код подтверждения из SMS/приложения банка
10. Подтвердить оплату на странице 3-D Secure

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Произошел редирект на страницу 3-D Secure
- Аутентификация 3-D Secure прошла успешно
- Платежный шлюз вернул статус "Успешно"
- Статус заказа обновлен на "Оплачен"
- Пользователю отображено сообщение об успешной оплате
- На email пользователя отправлен чек

---

### TC-003: Отклонение платежа банком (недостаточно средств)

**ID:** TC-003

**Название:** Отклонение платежа банком из-за недостаточности средств на карте

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть банковская карта с недостаточным балансом (тестовая карта для симуляции отказа: 4000 0000 0000 9995)
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести номер карты: 4000 0000 0000 9995
4. Ввести срок действия карты: 12/26
5. Ввести CVV: 123
6. Ввести имя держателя карты: IVAN IVANOV
7. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Платежный шлюз вернул статус "Отклонено банком" с причиной "Недостаточно средств"
- Статус заказа обновлен на "Оплата отклонена"
- Пользователю отображено сообщение об ошибке: "Платеж отклонен банком. Недостаточно средств на карте"
- Чек на email не отправлен

---

### TC-004: Отклонение платежа банком (карта заблокирована)

**ID:** TC-004

**Название:** Отклонение платежа банком из-за блокировки карты

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть заблокированная банковская карта (тестовая карта для симуляции: 4000 0000 0000 0069)
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести номер карты: 4000 0000 0000 0069
4. Ввести срок действия карты: 12/26
5. Ввести CVV: 123
6. Ввести имя держателя карты: IVAN IVANOV
7. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Платежный шлюз вернул статус "Отклонено банком" с причиной "Карта заблокирована"
- Статус заказа обновлен на "Оплата отклонена"
- Пользователю отображено сообщение об ошибке: "Платеж отклонен банком. Карта заблокирована"
- Чек на email не отправлен

---

### TC-005: Ошибка платежного сервиса (таймаут)

**ID:** TC-005

**Название:** Обработка ошибки платежного сервиса при таймауте соединения

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная банковская карта
- Платежный шлюз недоступен или возвращает таймаут (симуляция)

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидные данные карты
4. Нажать кнопку "Оплатить"
5. Дождаться обработки платежа (таймаут 30 секунд)

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Платежный шлюз вернул ошибку "Таймаут соединения" или не ответил в течение установленного времени
- Статус заказа обновлен на "Ошибка оплаты" или остался "Ожидает оплаты"
- Пользователю отображено сообщение об ошибке: "Произошла ошибка при обработке платежа. Попробуйте позже"
- Чек на email не отправлен
- Предложена возможность повторить попытку оплаты

---

### TC-006: Ошибка платежного сервиса (внутренняя ошибка)

**ID:** TC-006

**Название:** Обработка внутренней ошибки платежного сервиса

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная банковская карта
- Платежный шлюз возвращает ошибку 500 (симуляция)

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидные данные карты
4. Нажать кнопку "Оплатить"
5. Дождаться обработки платежа

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Платежный шлюз вернул статус "Ошибка платёжного сервиса"
- Статус заказа обновлен на "Ошибка оплаты"
- Пользователю отображено сообщение об ошибке: "Произошла техническая ошибка. Платеж не был обработан"
- Чек на email не отправлен
- Предложена возможность повторить попытку оплаты

---

### TC-007: Отмена оплаты на странице 3-D Secure

**ID:** TC-007

**Название:** Отмена оплаты пользователем на странице 3-D Secure

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть банковская карта, требующая 3-D Secure
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести данные карты, требующей 3-D Secure
4. Нажать кнопку "Оплатить"
5. Дождаться редиректа на страницу 3-D Secure
6. Нажать кнопку "Отмена" на странице 3-D Secure

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Произошел редирект на страницу 3-D Secure
- Пользователь отменил операцию на странице 3-D Secure
- Произошел возврат на страницу оплаты
- Статус заказа остался "Ожидает оплаты" или обновлен на "Оплата отменена"
- Пользователю отображено сообщение: "Оплата отменена"
- Чек на email не отправлен

---

### TC-008: Валидация пустого номера карты

**ID:** TC-008

**Название:** Проверка валидации при пустом поле "Номер карты"

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- Открыта страница оплаты заказа

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Оставить поле "Номер карты" пустым
4. Заполнить остальные поля валидными данными
5. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Кнопка "Оплатить" неактивна или при нажатии отображается ошибка валидации
- Под полем "Номер карты" отображается сообщение: "Поле обязательно для заполнения"
- Данные не отправляются в платежный шлюз
- Статус заказа не изменяется

---

### TC-009: Валидация неверного формата номера карты

**ID:** TC-009

**Название:** Проверка валидации при вводе номера карты неверного формата

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- Открыта страница оплаты заказа

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести номер карты: 1234 (неполный номер)
4. Заполнить остальные поля валидными данными
5. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Под полем "Номер карты" отображается сообщение: "Неверный формат номера карты"
- Данные не отправляются в платежный шлюз
- Статус заказа не изменяется

---

### TC-010: Валидация неверного формата номера карты (слишком длинный)

**ID:** TC-010

**Название:** Проверка валидации при вводе слишком длинного номера карты

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- Открыта страница оплаты заказа

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести номер карты: 4111 1111 1111 1111 1111 (20 цифр)
4. Заполнить остальные поля валидными данными
5. Попытаться ввести дополнительные символы

**Ожидаемый результат:**
- Поле "Номер карты" не принимает более 16-19 цифр (в зависимости от типа карты)
- Под полем отображается сообщение об ошибке или ввод ограничен автоматически
- Данные не отправляются в платежный шлюз

---

### TC-011: Валидация истекшего срока действия карты

**ID:** TC-011

**Название:** Проверка валидации при вводе истекшего срока действия карты

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- Открыта страница оплаты заказа
- Текущая дата: январь 2026

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидный номер карты
4. Ввести срок действия карты: 01/26 (прошедший месяц)
5. Заполнить остальные поля валидными данными
6. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Под полем "Срок действия" отображается сообщение: "Срок действия карты истек"
- Данные не отправляются в платежный шлюз
- Статус заказа не изменяется

---

### TC-012: Валидация пустого поля CVV

**ID:** TC-012

**Название:** Проверка валидации при пустом поле CVV

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- Открыта страница оплаты заказа

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Заполнить все поля валидными данными, кроме CVV
4. Оставить поле CVV пустым
5. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Под полем "CVV" отображается сообщение: "Поле обязательно для заполнения"
- Данные не отправляются в платежный шлюз
- Статус заказа не изменяется

---

### TC-013: Валидация неверного формата CVV (менее 3 цифр)

**ID:** TC-013

**Название:** Проверка валидации при вводе CVV менее 3 цифр

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- Открыта страница оплаты заказа

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Заполнить все поля валидными данными
4. Ввести CVV: 12 (2 цифры)
5. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Под полем "CVV" отображается сообщение: "CVV должен содержать 3 цифры" (или 4 для American Express)
- Данные не отправляются в платежный шлюз
- Статус заказа не изменяется

---

### TC-014: Валидация неверного формата CVV (буквы)

**ID:** TC-014

**Название:** Проверка валидации при вводе букв в поле CVV

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- Открыта страница оплаты заказа

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Заполнить все поля валидными данными
4. Ввести CVV: abc
5. Попытаться ввести буквы

**Ожидаемый результат:**
- Поле CVV не принимает буквы, только цифры
- Под полем отображается сообщение об ошибке или ввод ограничен автоматически
- Данные не отправляются в платежный шлюз

---

### TC-015: Валидация пустого поля "Имя держателя карты"

**ID:** TC-015

**Название:** Проверка валидации при пустом поле "Имя держателя карты"

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- Открыта страница оплаты заказа

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Заполнить все поля валидными данными, кроме "Имя держателя карты"
4. Оставить поле "Имя держателя карты" пустым
5. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Под полем "Имя держателя карты" отображается сообщение: "Поле обязательно для заполнения"
- Данные не отправляются в платежный шлюз
- Статус заказа не изменяется

---

### TC-016: Валидация имени держателя карты с цифрами

**ID:** TC-016

**Название:** Проверка валидации при вводе цифр в поле "Имя держателя карты"

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- Открыта страница оплаты заказа

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Заполнить все поля валидными данными
4. Ввести имя держателя карты: IVAN123
5. Нажать кнопку "Оплатить"

**Ожидаемый результат:**
- Под полем "Имя держателя карты" отображается сообщение: "Имя должно содержать только буквы"
- Данные не отправляются в платежный шлюз
- Статус заказа не изменяется

---

### TC-017: Минимальная сумма заказа

**ID:** TC-017

**Название:** Проверка оплаты заказа с минимальной суммой

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ на минимальную сумму (например, 1 рубль или 0.01 валютной единицы)
- У пользователя есть валидная банковская карта
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа с минимальной суммой
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидные данные карты
4. Нажать кнопку "Оплатить"
5. Дождаться обработки платежа

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Платежный шлюз принял платеж на минимальную сумму
- Платежный шлюз вернул статус "Успешно"
- Статус заказа обновлен на "Оплачен"
- Пользователю отображено сообщение об успешной оплате
- На email пользователя отправлен чек

---

### TC-018: Максимальная сумма заказа

**ID:** TC-018

**Название:** Проверка оплаты заказа с максимальной суммой

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ на максимальную сумму (лимит системы, например, 999 999 рублей)
- У пользователя есть валидная банковская карта с достаточным балансом
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа с максимальной суммой
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидные данные карты
4. Нажать кнопку "Оплатить"
5. Дождаться обработки платежа

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Платежный шлюз принял платеж на максимальную сумму
- Платежный шлюз вернул статус "Успешно"
- Статус заказа обновлен на "Оплачен"
- Пользователю отображено сообщение об успешной оплате
- На email пользователя отправлен чек

---

### TC-019: Срок действия карты - текущий месяц

**ID:** TC-019

**Название:** Проверка оплаты картой с сроком действия, равным текущему месяцу

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная банковская карта
- Текущая дата: февраль 2026
- Срок действия карты: 02/26

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидный номер карты
4. Ввести срок действия карты: 02/26 (текущий месяц)
5. Заполнить остальные поля валидными данными
6. Нажать кнопку "Оплатить"
7. Дождаться обработки платежа

**Ожидаемый результат:**
- Клиентская валидация прошла успешно (карта не считается истекшей, если срок действия равен текущему месяцу)
- Данные отправлены в платежный шлюз
- Платежный шлюз вернул статус "Успешно"
- Статус заказа обновлен на "Оплачен"
- Пользователю отображено сообщение об успешной оплате

---

### TC-020: Номер карты - минимальная длина (13 цифр для Visa)

**ID:** TC-020

**Название:** Проверка оплаты картой с минимальной длиной номера (13 цифр)

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная карта с номером из 13 цифр (редкий случай, но возможен для некоторых типов карт)
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести номер карты из 13 цифр: 4111111111111
4. Заполнить остальные поля валидными данными
5. Нажать кнопку "Оплатить"
6. Дождаться обработки платежа

**Ожидаемый результат:**
- Клиентская валидация прошла успешно (система принимает карты с 13 цифрами)
- Данные отправлены в платежный шлюз
- Платежный шлюз вернул статус "Успешно" или "Отклонено" в зависимости от типа карты
- Статус заказа обновлен соответственно

---

### TC-021: Номер карты - максимальная длина (19 цифр)

**ID:** TC-021

**Название:** Проверка оплаты картой с максимальной длиной номера (19 цифр)

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная карта с номером из 19 цифр (например, некоторые типы карт)
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести номер карты из 19 цифр: 4111111111111111111
4. Заполнить остальные поля валидными данными
5. Нажать кнопку "Оплатить"
6. Дождаться обработки платежа

**Ожидаемый результат:**
- Клиентская валидация прошла успешно (система принимает карты с 19 цифрами)
- Данные отправлены в платежный шлюз
- Платежный шлюз вернул статус "Успешно"
- Статус заказа обновлен на "Оплачен"

---

### TC-022: Проверка корректной передачи данных в платежный шлюз

**ID:** TC-022

**Название:** Проверка корректности передачи всех необходимых данных в платежный шлюз

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная банковская карта
- Платежный шлюз доступен и работает корректно
- Включено логирование запросов к платежному шлюзу

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести номер карты: 4111 1111 1111 1111
4. Ввести срок действия карты: 12/26
5. Ввести CVV: 123
6. Ввести имя держателя карты: IVAN IVANOV
7. Нажать кнопку "Оплатить"
8. Проверить логи запроса к платежному шлюзу

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- В запросе к платежному шлюзу переданы все необходимые данные:
  - Номер карты (замаскирован или зашифрован)
  - Срок действия карты
  - CVV
  - Имя держателя карты
  - Сумма заказа
  - ID заказа
  - Дополнительные параметры (валюту, описание и т.д.)
- Данные переданы в правильном формате согласно API платежного шлюза
- Платежный шлюз вернул корректный ответ

---

### TC-023: Проверка обработки ответа от платежного шлюза

**ID:** TC-023

**Название:** Проверка корректной обработки различных типов ответов от платежного шлюза

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная банковская карта
- Платежный шлюз доступен и работает корректно
- Включено логирование ответов от платежного шлюза

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидные данные карты
4. Нажать кнопку "Оплатить"
5. Дождаться обработки платежа
6. Проверить логи ответа от платежного шлюза

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Ответ от платежного шлюза корректно обработан приложением
- Статус заказа обновлен в соответствии с ответом платежного шлюза
- Пользователю отображено соответствующее сообщение
- Все поля ответа (transaction_id, status, error_code и т.д.) корректно сохранены в базе данных

---

### TC-024: Проверка обработки редиректа на 3-D Secure

**ID:** TC-024

**Название:** Проверка корректной обработки редиректа на страницу 3-D Secure

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть банковская карта, требующая 3-D Secure
- Платежный шлюз доступен и работает корректно

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести данные карты, требующей 3-D Secure
4. Нажать кнопку "Оплатить"
5. Дождаться редиректа на страницу 3-D Secure
6. Проверить URL и параметры редиректа

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Платежный шлюз вернул ответ с URL для редиректа на 3-D Secure
- Произошел корректный редирект на страницу 3-D Secure
- URL содержит необходимые параметры (MD, PaReq, TermUrl и т.д.)
- Страница 3-D Secure загрузилась корректно
- После успешной аутентификации произошел возврат на TermUrl

---

### TC-025: Проверка обработки callback от платежного шлюза

**ID:** TC-025

**Название:** Проверка корректной обработки callback-уведомления от платежного шлюза

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная банковская карта
- Платежный шлюз доступен и работает корректно
- Настроен endpoint для приема callback от платежного шлюза

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидные данные карты
4. Нажать кнопку "Оплатить"
5. Дождаться обработки платежа
6. Проверить получение и обработку callback от платежного шлюза

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Платежный шлюз отправил callback на указанный endpoint
- Callback корректно получен и обработан
- Статус заказа обновлен на основе данных из callback
- Проверена подпись callback (если используется)
- Обработаны все возможные статусы из callback

---

### TC-026: Проверка обработки сетевых ошибок при обращении к платежному шлюзу

**ID:** TC-026

**Название:** Проверка обработки сетевых ошибок при недоступности платежного шлюза

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная банковская карта
- Платежный шлюз недоступен (симуляция сетевой ошибки)

**Шаги:**
1. Открыть страницу оплаты заказа
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидные данные карты
4. Нажать кнопку "Оплатить"
5. Дождаться обработки запроса

**Ожидаемый результат:**
- Клиентская валидация прошла успешно
- Попытка отправки данных в платежный шлюз выполнена
- Зафиксирована сетевая ошибка (connection refused, timeout и т.д.)
- Статус заказа обновлен на "Ошибка оплаты" или остался "Ожидает оплаты"
- Пользователю отображено понятное сообщение об ошибке
- Предложена возможность повторить попытку оплаты
- Ошибка залогирована для последующего анализа

---

### TC-027: Проверка повторной попытки оплаты после ошибки

**ID:** TC-027

**Название:** Проверка возможности повторной попытки оплаты после ошибки платежного шлюза

**Предусловия:**
- Пользователь авторизован в системе
- У пользователя есть активный заказ, готовый к оплате
- У пользователя есть валидная банковская карта
- Предыдущая попытка оплаты завершилась ошибкой платежного сервиса
- Платежный шлюз снова доступен

**Шаги:**
1. Открыть страницу оплаты заказа (статус "Ошибка оплаты")
2. Выбрать способ оплаты "Банковская карта"
3. Ввести валидные данные карты (можно те же или другие)
4. Нажать кнопку "Оплатить"
5. Дождаться обработки платежа

**Ожидаемый результат:**
- Система позволяет выполнить повторную попытку оплаты
- Клиентская валидация прошла успешно
- Данные отправлены в платежный шлюз
- Платежный шлюз обработал запрос корректно
- Платежный шлюз вернул статус "Успешно"
- Статус заказа обновлен на "Оплачен"
- Пользователю отображено сообщение об успешной оплате
- На email пользователя отправлен чек
- В истории заказа зафиксированы обе попытки оплаты


# 2. Задача Playwright

**Запуск в двух браузерах:**
```bash
pytest -q --browser chromium --browser firefox .

import re
from playwright.sync_api import Page, expect

def test_check_title(page: Page) -> None:
    page.goto("https://playwright.dev/") 
    
    # Проверка, что заголовок соответствует ожидаемому значению 
    expect(page).to_have_title(re.compile("Playwright"))
```

# 3. Задача по теории вероятности
Каждый бросок даёт орла или решку с вероятностью \(1/2\), и все последовательности из трёх бросков равновероятны.

Всего возможных исходов \(2^3 = 8\):

- ООР, ОРО, РОО — это как раз случаи, где **ровно два орла** (3 варианта)
- остальные 5 исходов дают 0, 1 или 3 орла

Вероятность одного конкретного исхода (например, ООР) равна \((1/2)^3 = 1/8\).
Таких подходящих исходов 3, значит:

P = 3 * (1/8) = 3/8.

Ответ

3/8 = 0.375

